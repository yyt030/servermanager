<table class="table table-striped table-bordered table-hover model-list">
    <thead>
    <tr>
        {% if current_user.can(Permission.SERVER_DELETE) %}
            <th class="list-checkbox-column">
                <input type="checkbox" name="rowtoggle" class="action-rowtoggle" title="Select all records"/>
            </th>

            <th class="col-md-1"></th>
        {% endif %}
        <th class="column-header col-ip">所属项目组</th>
        <th class="column-header col-ip">环境</th>
        <th class="column-header col-ip">ip</th>
        <th class="column-header col-ip">操作系统版本</th>
        <th class="column-header col-ip">机器所属人</th>
    </tr>
    </thead>
    <tbody>
    {% for server in servers %}
        <tr bgcolor="#ffe4c4">
            {% if current_user.can(Permission.SERVER_EDIT) or current_user.can(Permission.DELETE) %}
                <td>
                    <input type="checkbox" name="rowid" class="action-checkbox" value="{{ server.id }}"
                           title="选择该记录"/>
                </td>
                <td class="list-buttons-column">
                    {% if current_user.can(Permission.SERVER_EDIT) %}
                        <a class="icon" href="{{ url_for('s.detail',id=server.id) }}" title="编辑">
                            <span class="glyphicon glyphicon-pencil"></span>
                        </a>
                    {% endif %}
                    {% if current_user.can(Permission.SERVER_DELETE) %}
                        <form class="icon" method="POST" action="{{ url_for('s.delete') }}">
                            <input id="id" name="id" type="hidden" value={{ server.id }}>
                            <button onclick="return confirm('确定删除ip:{{ server.ip }}?');"
                                    title="删除记录">
                                <span class="fa fa-trash glyphicon glyphicon-trash"></span>
                            </button>
                        </form>
                    {% endif %}
                </td>
            {% endif %}
            <td class="col-name">
                <a href="{{ url_for('site.search',filter='project', v=server.subproject.name) }}" data-toggle="tooltip"
                   title="查询该项目组{{ server.subproject.name }}下的所属机器">{{ server.subproject.name }}
                </a>
            </td>
            <td class="col-name">
                {% if server.envinfo %}{{ server.envinfo.location + server.envinfo.envname }}
                    {% else %}{{ server.use }}
                {% endif %}
            </td>
            <td class="col-name wa">
                {% if server.serverusers.count() and current_user.can(Permission.SERVER_LOGIN) %}
                    <div class="dropdown col-sm-2">
                        <a data-toggle="dropdown" href="#"><span class="glyphicon glyphicon-new-window"></span></a>
                        <ul class="dropdown-menu" role="menu">
                            {% for serveruser in server.serverusers %}
                                <li class="dropdown">
                                    <a class="icon"
                                       href="javascript:openTerm('{{ server.ip }}','{{ serveruser.username }}','{{ serveruser.password }}')">
                                        <span class="glyphicon glyphicon-play"></span>
                                        ssh {{ serveruser.username }}
                                    </a>
                                </li>
                            {% endfor %}
                        </ul>
                    </div>
                {% endif %}
                <a href="{{ url_for('s.detail',id=server.id) }}" data-toggle="tooltip" title="{{ server.use }}"
                   data-placement="right">{{ server.ip }}</a>
            </td>
            <td class="col-name">{{ server.oslevel }}</td>
            <td class="col-name">{{ server.contract_person }}</td>
        </tr>
    {% endfor %}
    </tbody>
</table>